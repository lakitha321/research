Abstract
The limitations of the traditional crosswalk system necessitate urgent reform for improved pedestrian safety and urban mobility. Inadequate pedestrian crossing times, prolonged waiting, emergency vehicle neglect, and a lack of 24/7 effective response mechanisms at traditional crosswalks pose pressing urban safety concerns. Our paramount objective is the creation of an advanced crosswalk system, underpinned by deep learning and image processing technologies. This research endeavors to innovate a sophisticated smart crosswalk system encompassing four key elements: a real-time Pedestrian Detection and Priority System tailored to special needs individuals, an adaptive vehicle availability and speed detective system in proximity to crosswalks, a real-time Emergency Vehicle Detection and Priority System fortified with rigorous verification protocols, and a robust framework for identifying pedestrian accidents and rule violations at crosswalks. The overall system is meticulously designed to not only enhance pedestrian safety by detecting potential hazards but also optimize traffic flow. In essence, it aspires to deliver a refined pedestrian crossing experience characterized by heightened safety and efficiency.
Keywords: Pedestrian Safety, Image Processing, Machine Learning, Deep Learning, Convolutional Neural Networks, YOLO, Traffic Light System

















Introduction
Pedestrian safety constitutes a critical concern within contemporary urban transportation systems, as pedestrian accidents and fatalities at crosswalks continue to pose significant challenges for cities worldwide. The lack of synchronization between pedestrians and vehicles has emerged as a primary factor leading to collisions and near-miss incidents, underscoring the urgency for advanced pedestrian safety solutions. According to the "Pedestrian safety, A road safety manual for decision-makers and practitioners" [1], pedestrians account for over 20% of the annual 1.24 million traffic-related fatalities, indicating the need for focused intervention to mitigate these preventable incidents.
The contemporary urban landscape is riddled with challenges near traditional crosswalks that demand immediate attention. These issues converge to create a complex web of safety concerns and inefficiencies. Pedestrians often find themselves grappling with inadequate time to safely travel across the road, a dilemma intensified for individuals with special needs. The alarming lack of priority for these vulnerable populations underscores a pressing need for Unbiased solutions. Moreover, the peculiar phenomenon of pedestrians idling near crosswalks in the absence of vehicular traffic is a common occurrence. This chronic wastage of time not only hampers urban productivity but also fosters frustration among citizens. Furthermore, the failure to prioritize emergency vehicles like ambulances at these junctures poses a considerable risk, potentially resulting in accidents that could have been avoided. The aftermath of vehicular-pedestrian accidents and rampant rule violations at traditional crosswalks reveals a concerning lack of structured protocols for education and continuous monitoring. This absence of a comprehensive response mechanism necessitates urgent attention. Addressing these multifaceted challenges near traditional crosswalks is pivotal for ensuring the safety, efficiency, and inclusivity of urban spaces.
The research centers on the innovative concept of a "Smart Crosswalk”, a comprehensive integration of Machine Learning, Deep Learning and Image Processing techniques. The system comprises four distinct components, each designed to contribute significantly to the enhancement of crosswalk safety and efficiency.
The initial emphasis lies in optimizing pedestrian crossing times through real-time Pedestrian Detection and Priority Systems. Tailored to accommodate individuals with specific needs, this approach leverages algorithms to anticipate the crossing times according to the no of individuals present. The resultant dynamic adaptation of pedestrian traffic light signals facilitates the secure and efficient movement of pedestrians, promoting inclusivity and equitable access. 
Furthermore, the research delves into the refinement of decreasing the idling times of the pedestrians, and confronting the best time for the people to cross the road through a responsive system predicated on real-time vehicle availability and uncontrollable speeds. This departure from conventional static systems enables the adjustment of signal timings in response to dynamic traffic patterns, orchestrating a harmonious coexistence between pedestrian and vehicular flow.
In emergency scenarios, the research introduces a Real-time Emergency Vehicle Detection and Priority System, reinforced by verification mechanisms. This technology swiftly identifies and prioritizes emergency vehicles, thus minimizing disruptions to both pedestrian and vehicular traffic, while concurrently streamlining the responsiveness of emergency services.
The research also addresses informing authorities on accidents and the enforcement of pedestrian and vehicle violation of rules. Employing image processing and machine learning methodologies, the system identifies pedestrian accidents and rule violations, thereby promoting safer urban environments and reinforcing adherence to traffic regulations.
Each facet of the “Smart Crosswalk” system operates in concert, embodying a holistic approach to crosswalk safety and efficiency. Through the integration of computer vision, deep learning and sophisticated image processing techniques, this research seeks to bridge the gap between technological innovation and urban well-being. The ensuing sections of this paper will expound upon the architecture, methodologies, experimental configurations, and outcomes, culminating in a comprehensive understanding of the Smart Crosswalk system's viability and efficacy. Its real-time detection, adaptive traffic light management, emergency response optimization, and enforcement of regulations collectively represent a concerted effort towards cultivating safer and more efficient crosswalks. By contributing to the discourse surrounding technology-driven urban infrastructure enhancement, this research aims in propelling the advancement of safer and more intelligent crosswalks on a global scale. 

Literature Review
In urban settings, the safety and efficiency of pedestrian movement at crosswalks have become pressing concerns. This literature review focuses on persistent issues near traditional crosswalks, namely the insufficient time allocated for pedestrian crossings, the perplexing idling of pedestrians in the absence of vehicular traffic, and the lack of priority for emergency vehicles. Additionally, post-accident response mechanisms remain ambiguous. Through an exploration of existing research, this review aims to uncover the intricacies of these challenges, pinpoint gaps in knowledge, and lay the foundation for potential solutions. Addressing these issues is essential for enhancing pedestrian safety, optimizing urban mobility, and shaping effective policies.
The paper "A Review on Pedestrian Crossing Detection and Behavior Analysis" by J. Z. Zhang and Y. Fuliang Li provides an overview of the existing research on pedestrian crossing detection and behavior analysis. It highlights various techniques and approaches used for pedestrian detection, tracking, and behavior analysis [2].
The research paper titled "The Pedestrian Detecting and Counting System Based on Automatic Method of S. G. and H. H. Yuejin Wang" proposes a system for pedestrian detection and counting based on an automatic method of image processing. The system uses a combination of algorithms for image processing, such as background subtraction, Gaussian mixture model (GMM), and blob analysis [3].
The paper "Pedestrian Detection, Tracking, Counting, Waiting Time Calculation and Trajectory Detection for Pedestrian Crossings Traffic light systems" by G. U. G. K. S. Wickramasinghe presents a system for detecting and tracking pedestrians at pedestrian crossings and estimating their waiting time. The system uses image processing techniques and computer vision algorithms to identify pedestrians and track their movement. [4]
“Vehicle Detection and Speed Tracking [5]” focuses on the detection of vehicle speed using various techniques and algorithms, such as background subtraction, vehicle tracking and feature extraction. The goal is to enhance traffic management and ensure citizen safety by providing efficient monitoring of vehicle movement. To collect additional vehicle and traffic data for this study, video recordings from cameras installed at traffic intersections will be used to identify and count the number of automobiles passing a particular area at a given time. To enforce traffic regulations and avoid accidents, technology may be used to calculate the speed of the driving cars and identify those that are traveling faster than the legal limit. The research is aimed at developing an automatic vehicle counting system and speed detection system that can process videos which are recorded from steady cameras located on the roads. The approach will be based on image processing techniques and machine learning algorithms as well.
The research “A Real-Time Vehicle Counting, Speed Estimation, and Classification System Based on Virtual Detection Zone and YOLO [6]” describes a study on the development of a real-time traffic detecting system that uses convolutional neural networks and YOLO for vehicle detection and classification. The study initializes a system that addresses challenges related to accurately locating and classifying vehicles in traffic flows, as well as dealing with total blockages that can obstruct vehicle tracking. The proposed system relies on a pre-defined zone, GMM, and YOLO algorithm to improve the efficiency of vehicle tallying. The estimated speed of cars had an average absolute percentage of 7.6%, and the suggested technique produced good classification accuracy in a variety of datasets and situations. The study's conclusions suggest that the suggested approach would work well for real-time traffic monitoring, which might have significant implications for organizations in charge of regulating traffic.
In the research paper titled “A Self-Adaptive Traffic Light Control System Based on Speed of Vehicles [7]” the authors present a system that utilizes V2I communication, whereby vehicles transmit their information regarding the speed to the traffic lights and them controlling the traffic lights considering situations. Using this data, the signal timings are dynamically adjusted in realtime with the aim of optimizing vehicle flow across the intersection and lowering traffic congestion on main roadways. Furthermore, the method used in this study relies on the presumption that the driver can regulate the speed of the car. The technology has the potential to greatly decrease traffic and enhance the security and dependability of transportation networks by utilizing real-time data and non-orthogonal signals.
A traffic light control system was proposed by Divij N, Divya K, and Anuradha Badage, which aims to detect the siren sound of approaching emergency vehicles and prioritize their passage through intersections. The proposed system integrates a sound detection sensor, camera, and microcontroller into a smart object, which processes the data. To facilitate communication between the smart objects and a centralized Decision Support System installed at the signal junction, LoRa technology is used. By utilizing the Decision Support 4 System, the system is able to make informed decisions about clearing traffic in the lane where the emergency vehicle is passing [8].
The research paper "Ambulance Detection using Image Processing" presents a novel approach to traffic light control system design. The traffic light control system designed by Bhoomika G M has shown the potential for using image processing and neural networks to improve traffic management. The proposed ambulance detection system builds on this work to identify and prioritize ambulances in traffic. By using CNN and YOLOv5, the system can accurately detect ambulances even in crowded traffic conditions. The system's ability to switch traffic signals green for 30 seconds to allow ambulances to pass through intersections can significantly reduce the time it takes for ambulances to reach their destinations, ultimately saving lives[9]. 
In "Ambulance Detection Using Image Processing and Neural Networks," Agrawal, K; Nigam, M K; Bhattacharya, S; G, Sumathi introduce an inventive system integrating YOLOv3 and CNN technologies and surveillance cameras. This system, tailored for India and Thailand, swiftly identifies ambulances at junctions, initiating a 15-second green signal for efficient traffic clearance. The setup's cost-effectiveness, facilitated by a single microcontroller with WIFI, and its rapid response due to remote camera-based detection, collectively contribute to improved traffic management and emergency responses—a crucial advancement for tackling traffic congestion[10].
One study by Hadi_Ghahremannezhad, Hang_Shi and Chengjun_Liu.  “Real-Time Accident Detection in Traffic Surveillance Using Deep Learning [11]”. This study introduces a brand-new, effective framework for junction accident detection for applications involving traffic monitoring. The proposed architecture consists of 3 hierarchical stages: accurate and efficient object identification using the YOLO_v4 technique, object tracking using a Kalman filter in combination with the Hungarian algorithm for association, and detecting accidents using trajectory conflict analysis.
Another study by Marjan Simončič.  “Road accidents in Slovenia involving a pedestrian, cyclist or motorcyclist and a car [12]”. This study examines a set of traffic collisions involving a motor_vehicle, a pedestrian, a bicycle, or a motorcyclist in Slovenia. Then, the logistic regression method is used to analyze the chosen group.
 Another study by Jianqing-Wu, Hao Xu and Yongsheng-Zhang.  “An improved vehiclepedestrian near-crash identification method with a roadside LiDAR sensor [13]”. This essay concentrates on probable collisions between walkers and moving cars as a threat to pedestrian safety. object tracking, object grouping, object classification, background filtering, and lane identification. For the purpose of classifying conflict risk, 3 indicators. The post encroachment time (PET), the percentage of the stopping distance (PSD), and the crash possibility index (CPI) are used. At four locations in Reno, Nevada, the performance of the developed methodology was assessed using information from field. The outcomes of case studies show that the suggested strategy might successfully identify pedestrian-vehicle near-crash situations. The suggested strategy in this research is particularly effective for identifying pedestrian-vehicle near-collisions at specific places.










Methodology 
Real-time Pedestrian Detection and Priority System for people with special needs on Crosswalks.
The proposed methodology outlines a comprehensive approach to enhance pedestrian safety at crossings by integrating computer vision techniques, deep learning, and image processing. The methodology covers data collection, preprocessing, model training, prioritization of disabled pedestrians, time estimation, validation, implementation, and comparison with existing methods.
In the data collection phase, real-time CCTV footage of pedestrian crossings is gathered for various scenarios and augmented using simulation tools. The collected data is then annotated to identify pedestrians, particularly disabled pedestrians, to create a labeled dataset for model training by using YOLO.
Subsequently, the collected CCTV footage undergoes preprocessing to eliminate noise and irrelevant information. Using image processing techniques, relevant features of pedestrians and disabled pedestrians are extracted, ensuring that only pertinent data is used for analysis.
A deep learning-based model is developed through model training, using the annotated dataset to detect and count pedestrians, including those with disabilities. Transfer learning is employed to expedite the training process by leveraging pre-trained models.
A methodology is devised to prioritize disabled pedestrians based on various factors, such as physical condition and mobility aids. This involves analyzing detected pedestrians' features and characteristics to facilitate efficient traffic management and enhance safety.
Time estimation for pedestrian road crossing is achieved by utilizing detected features and prioritization of disabled pedestrians. Techniques like optical flow and time-lapse analysis are employed to predict pedestrian movement and estimate crossing duration.
The developed model and methodology undergo validation through testing in diverse pedestrian crossing scenarios. The accuracy and performance of the model are evaluated against ground truth data to verify its effectiveness and reliability. Real-world implementation of the model and methodology in an actual pedestrian crossing scenario assesses their practical feasibility, efficiency, and suitability for deployment.
Finally, the results obtained from the model and methodology are compared with existing state-of-the-art methods. This comparative analysis highlights the advancements achieved and underscores the practical utility of the proposed approach.
In summary, the methodology integrates data collection, preprocessing, deep learning, and image processing techniques to enhance pedestrian safety. It addresses accurate pedestrian detection, prioritization of disabled pedestrians, and time estimation for safer crossings. Validation, real-world implementation, and comparison with existing methods contribute to the methodology's practicality and effectiveness.


A Real-time Responsive System on Vehicle Availability, Density and Uncontrollable speeds near crosswalks
The core of the system involves adjusting traffic signals accordingly by evaluating real time road conditions through determining vehicle availability coupled with the detection and reporting of uncontrollable speeds.
Operating in real-time, the system comes into action when considerable amount of pedestrian’s approaches a crossing. This dynamic monitoring mechanism optimizes pedestrian crossing times, eliminating the need for prolonged idling periods. The system's surveillance is finely tuned to a specific distance along the road, with particular attention given to the roadblock farthest from the pedestrian crossing. Employing sophisticated metrics, it conducts a comprehensive assessment of vehicle availability, considering both vehicle density and the availability. When the system deems the road safe for crossing, it promptly triggers a signal to the traffic lights. This signal orchestrates a seamless transition, illuminating red for vehicular traffic and green for pedestrians, thereby creating a secure environment for pedestrians to traverse the crossing. This synchronization is pivotal in ensuring pedestrian safety, while also minimizing traffic disruption.
For vehicle detection and availability assessment, the system employs the YOLOv8 model. Trained and implemented, this model analyzes live video feeds from cameras near pedestrian crossings. YOLO's real-time video stream handling capabilities facilitate rapid and precise vehicle detection, and its established reputation as a reliable object detection algorithm makes it an apt choice for this application.
An additional significant aspect of the system addresses the challenge of vehicles approaching crosswalk areas at uncontrollable speeds during red to green interval which is the yellow light. In such cases, if an excessive speed is detected within a predefined distance, it will be embedded with the vehicle availability result and change traffic light so that it won’t cost human life near crosswalks. The uncontrollable speeds of vehicles are detected and it will be recorded separately. This enhancement aims to bolster pedestrian safety, curbing potential vehicle-pedestrian collisions.
The developed traffic light control algorithm assumes paramount significance within the system's architecture, serving as its core. This algorithm considers multifaceted factors, including pedestrian safety, road availability based on density, availability, and speed limits. Testing and evaluating the system constitute a crucial phase, as it ensures the system's performance aligns with desired standards and is reliable in real-world conditions. 







Real-time Emergency Vehicle Detection and Priority System with Verification for Crosswalks
The envisioned emergency vehicle detection system is engineered to function seamlessly in real-time scenarios, particularly during instances when traffic signals transition from green for pedestrians to red for vehicles. This pivotal juncture demands utmost vigilance to grant emergency vehicles the right of way and facilitate their swift, secure passage through intersections.
To achieve this goal, the system employs a pair of sound sensors strategically positioned near the crosswalk. These sensors are designed to identify the distinct siren sound emitted by approaching emergency vehicles and triangulate their directional origin. This auditory data is relayed to the system, which harnesses advanced machine learning algorithms to analyze live CCTV feeds from intersection-installed cameras. This analysis is geared toward confirming whether the detected vehicle indeed belongs to the category of an ambulance. In the affirmative case, the system promptly allocates priority to the ambulance and temporarily halts pedestrians from crossing the road, mitigating the risk of potential accidents.
Upon verification of the vehicle's emergency status, the system triggers communication with the traffic control infrastructure, petitioning for expedited passage clearance for the ambulance through the intersection. This communication extends to orchestrate the synchronized operation of traffic lights and affiliated devices, guaranteeing a secure and unobstructed path for the ambulance to traverse. Concurrently, the system maintains continuous surveillance over the ambulance's movement, assuring that it navigates the crosswalk without hindrance.
Post the ambulance's successful transit through the intersection, the system proffers the green signal to pedestrians, signifying their permission to cross the road. This strategic sequencing ensures that pedestrians are not unduly delayed while also honoring their priority after the emergency vehicle has safely negotiated the junction.
The system's proficiency in identifying emergency vehicles, expediting their intersection passage, and affording pedestrians a secure and timely crossing signifies its pivotal role in safeguarding the well-being of both motorists and pedestrians alike. Leveraging its real-time monitoring capabilities, machine learning algorithms, and seamless integration with the traffic control infrastructure, the envisaged emergency vehicle detection system stands poised to substantially curtail emergency response times, forestall accidents, and ultimately preserve human lives.








Pedestrian accident and rule violation detection on crosswalk
To construct a robust training dataset, a collection of synthetic images was meticulously created. These images were generated using graphical tools to closely mimic real-world accident scenarios while maintaining visual realism. The dataset encompasses diverse lighting conditions, pedestrian behaviors, and vehicle movements, simulating actual accident instances. This approach was chosen due to the unavailability of publicly accessible real-world accident images, while still ensuring data diversity and relevance.
A custom YOLOv5 model was tailored for accurate accident detection using the synthetic dataset. The model was fine-tuned to discern pedestrians and vehicles within accident-prone scenes. Carefully annotated bounding boxes depicted the precise locations of pedestrians and vehicles involved in accidents. The training process encompassed optimizing hyperparameters and employing appropriate loss functions. This enabled the model to learn intricate features associated with accident scenarios, contributing to its ability to detect and localize accidents accurately.
A specialized YOLO-based model was developed to identify vehicles crossing crosswalks during red light conditions, indicative of rule violations. Trained using images depicting red light violation instances, the model learned to recognize vehicles disobeying signals. This approach enhances pedestrian safety by promptly identifying and reporting violations, contributing to a safer road environment.
Upon detecting red light violations and pedestrian accidents, a dedicated system promptly logs critical information, including date, time, location, and vehicle details. This information is efficiently channeled to an interactive dashboard designed for authorities. The dashboard provides real-time visualization of incidents, aiding authorities in immediate response and intervention. This streamlined reporting mechanism enhances collaboration between the system and authorities, contributing to timely and effective management of road safety. 
The system incorporates a pedestrian violation counting mechanism to quantify instances of pedestrians crossing roads during red light conditions. By tallying these violations, the system provides a quantifiable measure of its efficiency in addressing unsafe pedestrian behaviors. This data serves as a valuable metric for evaluating the system's effectiveness and can guide improvements in enhancing pedestrian adherence to traffic rules, ultimately contributing to safer pedestrian crossings.








Results and Discussions 
Developed pedestrian detection model showcased a remarkable accuracy rate in identifying pedestrians looking forward to crossing the road. The model's precision and recall metrics consistently outperformed previous methodologies. We observed an average accuracy of correctly identifying pedestrians across various scenarios, considering different lighting conditions and crowd densities. This result was maintained even when distinguishing disabled pedestrians, which is a crucial aspect of ensuring their safety.
 

The time estimation model we devised demonstrated an efficient prediction of the time required for pedestrians to cross the road. By integrating variables such as disabled pedestrian priority, pedestrian density, our model accurately predicted the crossing time. The average time estimation error was within 12 seconds, indicating the model's robustness in dynamically adapting to real-time congested conditions.

Implemented components demonstrated a successful integration of multiple components into a responsive system aimed at reducing pedestrian idling times near crosswalks. A custom YOLO model was trained to distinguish between bare and filled roads, and YOLOv8 was employed to confirm real-time road availability. Furthermore, the system measured vehicle speeds, enabling the detection of uncontrollable speeds surpassing a predefined threshold which ultimately provides safe crossing experience. 
 

The integration of these elements culminated in an efficient algorithm for determining the optimal time for pedestrians to cross the road. Notably, the custom model exhibited promising performance, as evidenced by the confusion matrix, indicating robust classification accuracy. The images depicting the final output of road conditions – bare and filled – (Figure 01) (Figure 02) serve as visual confirmation of the system's capability to assess real-time road conditions. This research advances the development of responsive pedestrian-crossing systems, offering potential benefits in terms of pedestrian safety and traffic flow optimization.
The implemented emergency vehicle detection system, combining YOLOv5 and IoT technologies, presents a robust solution for enhancing intersection safety. By effectively identifying ambulances through the YOLOv5 model and utilizing IoT sound sensors to determine their direction, the system ensures timely and safe passage of emergency vehicles through crosswalks. This approach addresses a critical juncture where rapid vehicle movement is essential while protecting pedestrian rights.







The real-time operation of the system, triggered by imminent traffic light changes, underlines its responsiveness in high-stress scenarios. The synchronized coordination between sound sensors, machine learning algorithms, and traffic control mechanisms exemplifies the system's agility in swiftly verifying the nature of an approaching vehicle. This intelligent verification process guarantees that only legitimate emergency vehicles, like ambulances, receive priority clearance, minimizing disruption to pedestrian traffic and averting potential accidents
Custom YOLOv5 model demonstrated commendable accuracy in detecting pedestrian-vehicle accidents. The system accurately identified pedestrians and vehicles involved in accident scenarios, enabling precise localization and reporting. Figure 1 illustrates the final output of the accident detection module, showcasing its ability to discern critical accident instances.
 
Pre-trained vehicle detection YOLO-based model effectively identified vehicles crossing crosswalks during red light conditions, highlighting potential rule violations. This real-time identification contributes to enhancing pedestrian safety by promptly notifying authorities and aiding intervention.
The information dissemination mechanism efficiently relayed critical accident and rule violation details to authorities through an interactive dashboard. This streamlined reporting enhances the collaboration between the system and authorities, leading to prompt responses and interventions.

